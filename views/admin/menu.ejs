<%- include("../partials/admin-start", { title }) %>

<h1 class="text-3xl font-serif text-thought mb-8">Menu Management</h1>
<p class="text-thought/60 mb-6">Edit the titles of the navigation menu items.</p>

<% if (saved) { %>
  <div class="mb-6 border border-action/30 bg-white p-4 text-thought/80">Saved.</div>
<% } %>

<div class="bg-white border border-warmth/20 p-4 mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
  <div>
    <h2 class="text-lg font-serif text-thought">Sync Default Structure</h2>
    <p class="text-sm text-thought/60">
      Rebuilds the navigation to the updated sitemap and ensures all default pages exist. Existing menu items will be replaced.
    </p>
  </div>
  <form method="post" action="/admin/menu/sync">
    <button type="submit" class="bg-action text-white px-5 py-2 text-sm font-medium hover:bg-action/90 transition-colors">Sync Navigation</button>
  </form>
</div>

<div class="bg-white border border-warmth/20 rounded shadow-sm">
  <% (menuItems || []).forEach((item) => { %>
    <div class="py-3 px-4 border-b border-warmth/10 hover:bg-warmth/5">
      <form method="post" action="/admin/menu/<%= encodeURIComponent(item.id) %>" class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
        <div class="flex-1">
          <div class="text-xs text-thought/50 mb-1"><%= item.url || "" %></div>
          <input
            name="title"
            value="<%= item.title %>"
            class="w-full p-2 border border-warmth/30 rounded focus:border-thought outline-none"
          />
        </div>
        <button type="submit" class="bg-action text-white px-4 py-2 text-sm font-medium hover:bg-action/90 transition-colors w-fit">Save</button>
      </form>
    </div>

    <% (item.children || []).forEach((child) => { %>
      <div class="py-3 px-4 border-b border-warmth/10 hover:bg-warmth/5 pl-12 bg-gray-50">
        <form method="post" action="/admin/menu/<%= encodeURIComponent(child.id) %>" class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
          <div class="flex-1">
            <div class="text-xs text-thought/50 mb-1"><%= child.url || "" %></div>
            <input
              name="title"
              value="<%= child.title %>"
              class="w-full p-2 border border-warmth/30 rounded focus:border-thought outline-none"
            />
          </div>
          <button type="submit" class="bg-action text-white px-4 py-2 text-sm font-medium hover:bg-action/90 transition-colors w-fit">Save</button>
        </form>
      </div>
    <% }) %>
  <% }) %>
</div>

<%- include("../partials/admin-end") %>

